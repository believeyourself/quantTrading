# 资金费率套利策略 - 监控模式修改说明

## 修改概述

已将资金费率套利策略从自动交易模式改为**监控模式**，现在系统只提供通知功能，不执行自动交易。

## 主要修改内容

### 1. 策略参数修改
- **默认设置**: `auto_trade: False` - 关闭自动交易
- **配置文件**: `config/funding_monitor_config.json` 添加 `"auto_trade": false`
- **系统配置**: `config/settings.py` 中资金费率套利策略默认关闭自动交易

### 2. 策略逻辑修改
- **移除自动交易**: 不再执行开仓和平仓操作
- **保留通知功能**: 继续发送Telegram通知
- **简化启动流程**: 移除复杂的持仓管理和风险监控
- **更新通知内容**: 明确标注为"监控模式"和"建议做多/做空"

### 3. API接口修改
- **默认参数**: `create_funding_strategy()` 函数默认关闭自动交易
- **保留接口**: 所有API接口保持不变，但行为改为监控模式

### 4. Web界面修改
- **移除平仓按钮**: 不再显示"平掉所有持仓"按钮
- **更新说明**: 界面标题改为"自动化资金费率监控系统"
- **移除持仓显示**: 不再显示当前持仓信息
- **保留功能**: 启动、停止、更新缓存功能保持不变

### 5. 通知消息更新
- **模式标注**: 所有通知消息都标注"监控模式（仅通知，不自动交易）"
- **建议方向**: 将"做多/做空"改为"建议做多/建议做空"
- **移除交易信息**: 不再显示持仓和盈亏信息

## 功能对比

| 功能 | 自动交易模式 | 监控模式 |
|------|-------------|----------|
| 自动开仓 | ✅ | ❌ |
| 自动平仓 | ✅ | ❌ |
| 风险监控 | ✅ | ❌ |
| 持仓管理 | ✅ | ❌ |
| 资金费率监控 | ✅ | ✅ |
| Telegram通知 | ✅ | ✅ |
| 池子管理 | ✅ | ✅ |
| 回测功能 | ✅ | ✅ |

## 使用方法

### 启动监控模式
```python
from strategies.funding_rate_arbitrage import FundingRateArbitrageStrategy

# 创建监控模式策略
strategy = FundingRateArbitrageStrategy({
    'funding_rate_threshold': 0.005,  # 0.5%
    'max_positions': 10,
    'min_volume': 1000000,
    'auto_trade': False  # 监控模式
})

# 启动策略
strategy.start_strategy()
```

### Web界面使用
1. 启动API服务: `python start_api.py`
2. 启动Web界面: `python start_web.py`
3. 访问 http://localhost:8050
4. 点击"启动策略"开始监控

### 测试监控模式
```bash
python test_monitor_mode.py
```

## 通知示例

### 池子变化通知
```
🔄 合约池变化通知
⏰ 时间: 2024-01-15 14:30:00
📊 阈值: 0.5000%
💡 模式: 监控模式（仅通知，不自动交易）

🟢 新增合约 (2个):
  • BTCUSDT: 0.0080% (建议做多)
  • ETHUSDT: -0.0060% (建议做空)
```

### 池子状态通知
```
📊 当前合约池状态
⏰ 更新时间: 2024-01-15 14:30:00
📈 合约数量: 5个
🎯 阈值: 0.5000%
💡 模式: 监控模式（仅通知，不自动交易）

  • BTCUSDT: 0.0080% (建议做多)
  • ETHUSDT: -0.0060% (建议做空)
  • ADAUSDT: 0.0055% (建议做多)
```

## 注意事项

1. **手动交易**: 系统只提供建议，实际交易需要手动执行
2. **风险控制**: 用户需要自行控制交易风险
3. **参数调整**: 可以通过配置文件调整监控参数
4. **通知频率**: 可以通过 `funding_rate_check_interval` 调整检测频率

## 恢复自动交易

如果需要恢复自动交易功能，可以：

1. 修改策略参数: `'auto_trade': True`
2. 修改配置文件: `config/funding_monitor_config.json` 中设置 `"auto_trade": true`
3. 重启策略

但请注意，自动交易存在风险，请谨慎使用。 